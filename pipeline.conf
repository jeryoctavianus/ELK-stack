input{
	file{
		#path=>"/var/log/apache2/access.log"
		path=>"/home/jeryoctavianus/Desktop/data science/access-parsed.log"
		start_position=>"beginning"
	}

}

filter{
	grok{
		match => {"message" => 
			[
			'%{IP:ip_address} %{USER:identity} %{USER:auth} \[%{HTTPDATE:req_ts}\] "%{WORD:http_verb} /%{WORD:station}/%{WORD:request_station}.%{WORD:txt_php}\?%{WORD:txt_id}=%{WORD:sensor_id}&%{WORD:txt_tempf}=%{NUMBER:suhu:float}&%{WORD:txt_humidity}=%{NUMBER:kelembapan:float}&%{WORD:txt_softwaretype}=%{WORD:key}&%{WORD:txt_action}=%{WORD:action}&%{WORD:txt_realtime}=%{INT:realtime_bool:int}&%{WORD:txt_rtfreq}=%{INT:freq:int} %{WORD:method}\/%{NUMBER:http_version}\" %{INT:http_status:int} %{INT:num_bytes:int}',
			'%{IP:ip_address} %{USER:identity} %{USER:auth} \[%{HTTPDATE:req_ts}\] "%{WORD:http_verb} /%{WORD:station}/%{WORD:request_station}.%{WORD:txt_php}\?%{WORD:txt_id}=%{WORD:sensor_id}&%{WORD:txt_tempf}=%{NUMBER:suhu:float}&%{WORD:txt_humidity}=%{NUMBER:kelembapan:float}&%{WORD:txt_dewptf}=%{NUMBER:dewptf:float}&%{WORD:txt_windchill}=%{NUMBER:windchill:float}&%{WORD:txt_windir}=%{NUMBER:windir:float}&%{WORD:txt_windspeed}=%{NUMBER:windspeed:float}&%{WORD:txt_windgust}=%{NUMBER:windgust:float}&%{WORD:txt_rain}=%{NUMBER:rainin:float}&%{WORD:txt_dailyrainin}=%{NUMBER:daily_rain:float}&%{WORD:txt_weeklyrain}=%{NUMBER:weekly_rain:float}&%{WORD:txt_monthlyrain}=%{NUMBER:monthly_rain:float}&%{WORD:txt_yearlyrain}=%{NUMBER:yearly_rain:float}&%{WORD:txt_solarradiation}=%{NUMBER:solar_radiation:float}&%{WORD:txt_UV}=%{NUMBER:UV:float}&%{WORD:txt_indoortempf}=%{NUMBER:indoor_temp:float}&%{WORD:txt_indoorhumidity}=%{NUMBER:indoor_humidity:float}&%{WORD:txt_baromin}=%{NUMBER:baromin:float}&%{WORD:txt_lowbatt}=%{NUMBER:lowbatt:float}&%{WORD:txt_dateutc}=%{INT:tahun}-%{INT:bulan}-%{INT:tanggal}\%%{INT:tahun2}:%{INT:tanggal2}:%{INT:bulan2}&%{WORD:txt_softwaretype}=%{WORD:key}\%%{WORD:logger}\%%{WORD:txt_version}.%{WORD:version2}.%{WORD:version3}&%{WORD:txt_action}=%{WORD:action}&%{WORD:txt_realtime}=%{INT:realtime_bool:int}&%{WORD:txt_rtfreq}=%{INT:freq:int} %{WORD:method}\/%{NUMBER:http_version}\" %{INT:http_status:int} %{INT:num_bytes:int}',
			'%{IP:ip_address} %{USER:identity} %{USER:auth} \[%{HTTPDATE:req_ts}\] "%{WORD:http_verb} /%{WORD:station}/%{WORD:request_station}.%{WORD:txt_php}\?%{WORD:txt_id}=%{WORD:sensor_id}&%{WORD:txt_action}=%{WORD:action}&%{WORD:txt_realtime}=%{INT:realtime_bool:int}&%{WORD:txt_rtfreq}=%{INT:freq:int}&%{WORD:txt_dewptf}=%{NUMBER:dewptf:float}&%{WORD:txt_windspeed}=%{NUMBER:windspeed:float}&%{WORD:txt_softwaretype}=%{WORD:key}&%{WORD:txt_dateutc}=%{INT:tahun}-%{INT:bulan}-%{INT:tanggal}\%%{INT:tahun2}:%{INT:bulan2}:%{INT:tanggal2}&%{WORD:txt_tempf}=%{NUMBER:suhu:float}&%{WORD:txt_humidity}=%{NUMBER:kelembapan:float} %{WORD:method}\/%{NUMBER:http_version}\" %{INT:http_status:int} %{INT:num_bytes:int}',
			'%{IP:ip_address} %{USER:identity} %{USER:auth} \[%{HTTPDATE:req_ts}\] "%{WORD:http_verb} /%{WORD:station}/%{WORD:request_station}.%{WORD:txt_php}\?%{WORD:txt_id}=%{WORD:sensor_id}&%{WORD:txt_tempf}=%{NUMBER:suhu:float}&%{WORD:txt_humidity}=%{NUMBER:kelembapan:float}&%{WORD:txt_softwaretype}=%{WORD:key}&%{WORD:txt_action}=%{WORD:action}&%{WORD:txt_realtime}=%{INT:realtime_bool:int}&%{WORD:rtfreq}=%{INT:freq:int} %{WORD:method}\/%{NUMBER:http_version}\" %{INT:http_status:int} %{INT:num_bytes:int}',
			'%{IP:ip_address} %{USER:identity} %{USER:auth} \[%{HTTPDATE:req_ts}\] "%{WORD:http_verb} /%{WORD:station}/%{WORD:request_station}.%{WORD:txt_php}\?%{WORD:txt_id}=%{WORD:sensor_id}&%{WORD:txt_tempf}=%{NUMBER:suhu:float}&%{WORD:txt_humidity}=%{NUMBER:kelembapan:float}&%{WORD:txt_dewptf}=%{NUMBER:dewptf:float}&%{WORD:txt_windchill}=%{NUMBER:windchill:float}&%{WORD:txt_windir}=%{NUMBER:windir:float}&%{WORD:txt_windspeed}=%{NUMBER:windspeed:float}&%{WORD:txt_windgust}=%{NUMBER:windgust:float}&%{WORD:txt_rain}=%{NUMBER:rainin:float}&%{WORD:txt_dailyrainin}=%{NUMBER:daily_rain:float}&%{WORD:txt_weeklyrain}=%{NUMBER:weekly_rain:float}&%{WORD:txt_monthlyrain}=%{NUMBER:monthly_rain:float}&%{WORD:txt_yearlyrain}=%{NUMBER:yearly_rain:float}&%{WORD:txt_solarradiation}=%{NUMBER:solar_radiation:float}&%{WORD:txt_UV}=%{NUMBER:UV:float}&%{WORD:txt_indoortempf}=%{NUMBER:indoor_temp:float}&%{WORD:txt_indoorhumidity}=%{NUMBER:indoor_humidity:float}&%{WORD:txt_baromin}=%{NUMBER:baromin:float}&%{WORD:txt_lowbatt}=%{NUMBER:lowbatt:float}&%{WORD:txt_dateutc}=%{INT:tahun}-%{INT:bulan}-%{INT:tanggal}\%%{INT:tahun2}:%{INT:tanggal2}:%{INT:bulan2}&%{WORD:txt_softwaretype}=%{WORD:logger}.%{WORD:version2}.%{WORD:version3}&%{WORD:txt_action}=%{WORD:action}&%{WORD:txt_realtime}=%{INT:realtime_bool:int}&%{WORD:txt_rtfreq}=%{INT:freq:int} %{WORD:method}\/%{NUMBER:http_version}\" %{INT:http_status:int} %{INT:num_bytes:int}',
			'%{IP:ip_address} %{USER:identity} %{USER:auth} \[%{HTTPDATE:req_ts}\] "%{WORD:http_verb} /%{WORD:station}/%{WORD:request_station}.%{WORD:txt_php}\?%{WORD:txt_id}=%{WORD:sensor_id}&%{WORD:txt_tempf}=%{NUMBER:suhu:float}&%{WORD:txt_humidity}=%{NUMBER:kelembapan:float}&%{WORD:txt_dewptf}=%{NUMBER:dewptf:float}&%{WORD:txt_windchill}=%{NUMBER:windchill:float}&%{WORD:txt_windir}=%{NUMBER:windir:float}&%{WORD:txt_windspeed}=%{NUMBER:windspeed:float}&%{WORD:txt_windgust}=%{NUMBER:windgust:float}&%{WORD:txt_rain}=%{NUMBER:rainin:float}&%{WORD:txt_dailyrainin}=%{NUMBER:daily_rain:float}&%{WORD:txt_weeklyrain}=%{NUMBER:weekly_rain:float}&%{WORD:txt_monthlyrain}=%{NUMBER:monthly_rain:float}&%{WORD:txt_yearlyrain}=%{NUMBER:yearly_rain:float}&%{WORD:txt_solarradiation}=%{NUMBER:solar_radiation:float}&%{WORD:txt_UV}=%{NUMBER:UV:float}&%{WORD:txt_indoortempf}=%{NUMBER:indoor_temp:float}&%{WORD:txt_indoorhumidity}=%{NUMBER:indoor_humidity:float}&%{WORD:txt_baromin}=%{NUMBER:baromin:float}&%{WORD:txt_lowbatt}=%{NUMBER:lowbatt:float}&%{WORD:txt_dateutc}=%{INT:tahun}-%{INT:bulan}-%{INT:tanggal}\%%{INT:tahun2}:%{INT:tanggal2}:%{INT:bulan2}&%{WORD:txt_softwaretype}=%{WORD:logger}.%{WORD:version2}.%{WORD:version3}&%{WORD:txt_action}=%{WORD:action}&%{WORD:txt_realtime}=%{INT:realtime_bool:int}&%{WORD:txt_rtfreq}=%{INT:freq:int} %{WORD:method}\/%{NUMBER:http_version}\" %{INT:http_status:int} %{INT:num_bytes:int}',
			'%{IP:ip_address} %{USER:identity} %{USER:auth} \[%{HTTPDATE:req_ts}\] "%{WORD:http_verb} /%{WORD:station}/%{WORD:request_station}.%{WORD:txt_php}\?%{WORD:txt_id}=%{WORD:sensor_id}&%{WORD:txt_tempf}=%{NUMBER:suhu:float}&%{WORD:txt_humidity}=%{NUMBER:kelembapan:float}&%{WORD:txt_dewptf}=%{NUMBER:dewptf:float}&%{WORD:txt_windchill}=%{NUMBER:windchill:float}&%{WORD:txt_windir}=%{NUMBER:windir:float}&%{WORD:txt_windspeed}=%{NUMBER:windspeed:float}&%{WORD:txt_windgust}=%{NUMBER:windgust:float}&%{WORD:txt_rain}=%{NUMBER:rainin:float}&%{WORD:txt_dailyrainin}=%{NUMBER:daily_rain:float}&%{WORD:txt_weeklyrain}=%{NUMBER:weekly_rain:float}&%{WORD:txt_monthlyrain}=%{NUMBER:monthly_rain:float}&%{WORD:txt_yearlyrain}=%{NUMBER:yearly_rain:float}&%{WORD:txt_solarradiation}=%{NUMBER:solar_radiation:float}&%{WORD:txt_UV}=%{NUMBER:UV:float}&%{WORD:txt_indoortempf}=%{NUMBER:indoor_temp:float}&%{WORD:txt_indoorhumidity}=%{NUMBER:indoor_humidity:float}&%{WORD:txt_baromin}=%{NUMBER:baromin:float}&%{WORD:txt_lowbatt}=%{NUMBER:lowbatt:float}&%{WORD:txt_dateutc}=%{INT:tahun}-%{INT:bulan}-%{INT:tanggal}\%%{INT:tahun2}:%{INT:tanggal2}:%{INT:bulan2}&%{WORD:txt_softwaretype}=%{WORD:logger}.%{WORD:version2}.%{WORD:version3}&%{WORD:txt_action}=%{WORD:action}&%{WORD:txt_realtime}=%{INT:realtime_bool:int}&%{WORD:txt_rtfreq}=%{INT:freq:int} %{WORD:method}\/%{NUMBER:http_version}\" %{INT:http_status:int} %{INT:num_bytes:int}'
			]
		}
	}

	mutate{
			convert=>{
				"response"=>"integer"
				"bytes"=>"integer"
			}
	}

	mutate{
			remove_field => [ "headers", "@version", "host", "identity", "auth", "http_verb", "station", "request_station", "txt_php", "txt_id", "txt_tempf", "txt_humidity", "txt_softwaretype", "key", "txt_action", "action", "txt_realtime", "realtime_bool", "txt_rtfreq", "freq", "method", "http_version", "txt_dewptf", "txt_windchill", "txt_windir", "txt_windspeed", "txt_windgust", "txt_rain", "txt_dailyrainin", "txt_weeklyrain", "txt_monthlyrain", "txt_yearlyrain", "txt_solarradiation", "txt_UV", "txt_indoortempf", "txt_indoorhumidity", "txt_baromin", "txt_lowbatt", "txt_dateutc", "tahun", "bulan", "tanggal", "tahun2", "bulan2", "tanggal2", "logger", "txt_version", "version2", "version3" ]
	}

	date{
		match => ["timestamp", "dd/MMM/yyyy:HH:mm:ss Z"]
		remove_field => [ "timestamp" ]
	}
}

output{
	elasticsearch{
		hosts => ["localhost:9200"]
		index => "cuaca"
		document_type => "default"
		http_compression => true
	}
}
